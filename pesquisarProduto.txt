def pesquisarProduto(): 
    print("pesquisar produto")
    vCodigo = vFormListarProdutos.edtCodigo.text()
    vDescricao = vFormListarProdutos.edtDescricao.text()
    print(f"pesquisar produto: {vCodigo} - {vDescricao}")
    vCursor = conn.vBanco.cursor()

    if vCodigo != "":
        vFormListarProdutos.edtDescricao.setText("")
        vComandoSQL = "SELECT * FROM PRODUTOS WHERE CODIGO = %s"
        vCursor.execute(vComandoSQL, (vCodigo,))
    elif vDescricao != "":
        vFormListarProdutos.edtCodigo.setText("")
        vComandoSQL = "SELECT * FROM PRODUTOS WHERE DESCRICAO LIKE %s"
        vCursor.execute(vComandoSQL, ('%' + vDescricao + '%',))
    else:
        QtWidgets.QMessageBox.warning(vFormListarProdutos,"Aviso", "Preencha o campo Código ou Descrição para pesquisar.")
        ListarProdutos()
        return  # Sai da função se nenhum campo foi preenchido
    
    vDadosRetornados = vCursor.fetchall()

    vFormListarProdutos.tabelaDados.setRowCount(len(vDadosRetornados))
    vFormListarProdutos.tabelaDados.setColumnCount(5)
    

    for linha in range(len(vDadosRetornados)):
        for coluna in range(0, 5):
            vFormListarProdutos.tabelaDados.setItem(linha, coluna, QtWidgets.QTableWidgetItem(str(vDadosRetornados[linha][coluna])))

    vFormListarProdutos.tabelaDados.resizeColumnsToContents()
    vFormListarProdutos.tabelaDados.horizontalHeader().setStretchLastSection(True)
    vFormListarProdutos.tabelaDados.horizontalHeader().setSectionResizeMode(QtWidgets.QHeaderView.Stretch)
